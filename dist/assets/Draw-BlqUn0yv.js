import{d as e,c as t,n as a,a as l,b as s,t as i,o as n,_ as r,u as o,e as c,r as d,f as u,w as p,g,h as m,i as x,j as v,k as b,l as y,v as f,F as h,m as w,p as k,q as C,s as j}from"./index-BMAZyIma.js";import{u as M}from"./settings-Bte2NL1Q.js";const P={class:"text-center"},_={class:"w-12 h-12 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-3"},D={class:"text-white font-bold text-lg"},W={class:"font-semibold text-gray-900 text-sm mb-1 truncate"},z={key:0,class:"text-xs text-gray-600 truncate"},A={key:1,class:"text-xs text-gray-500 truncate mt-1"},Q={key:2,class:"mt-2"},I=r(e({__name:"ParticipantCard",props:{participant:{},isSelected:{type:Boolean},isDrawing:{type:Boolean}},emits:["click"],setup:e=>(r,o)=>(n(),t("div",{class:a(["participant-card",{selected:e.isSelected,winner:e.participant.isWinner,"animate-bounce":e.isDrawing&&e.isSelected}]),onClick:o[0]||(o[0]=e=>r.$emit("click"))},[l("div",P,[l("div",_,[l("span",D,i(e.participant.name.charAt(0).toUpperCase()),1)]),l("h3",W,i(e.participant.name),1),e.participant.position?(n(),t("p",z,i(e.participant.position),1)):s("",!0),e.participant.group?(n(),t("p",A,i(e.participant.group),1)):s("",!0),e.participant.isWinner?(n(),t("div",Q,[...o[1]||(o[1]=[l("span",{class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"}," ğŸ† ç²çè€… ",-1)])])):s("",!0)])],2))}),[["__scopeId","data-v-96fc9fa8"]]),S={class:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-100"},q={class:"bg-white shadow-sm border-b border-gray-200"},B={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},U={class:"flex justify-between items-center py-4"},E={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},F={class:"card p-6 mb-8"},N={class:"flex flex-col md:flex-row justify-between items-center gap-4"},T={class:"text-gray-600"},V={class:"flex flex-col sm:flex-row gap-3 items-center"},$={class:"flex items-center gap-2"},G=["disabled"],H=["value"],J={class:"flex gap-3"},K=["disabled"],L={key:0,class:"mt-4"},O={class:"w-full bg-gray-200 rounded-full h-2"},R={class:"text-center text-sm text-gray-600 mt-2"},X={key:0,class:"card p-6 mb-8 text-center"},Y={class:"text-2xl font-bold text-purple-600 mb-2"},Z={class:"text-gray-600"},ee={class:"flex justify-center gap-4 mt-4"},te={class:"text-sm text-gray-500"},ae={class:"text-sm text-blue-600"},le={key:0,class:"text-sm text-orange-600 mt-2"},se={key:1,class:"card p-8 mb-8 text-center bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-200"},ie={class:"text-xl text-gray-700 mb-2"},ne={key:0,class:"text-lg text-gray-600 mb-4"},re={class:"text-lg font-semibold text-purple-600"},oe={key:2,class:"card p-8 mb-8 bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-200"},ce={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6"},de={class:"font-bold text-lg text-gray-900"},ue={key:0,class:"text-sm text-gray-600"},pe={class:"text-purple-600 font-medium mt-2"},ge={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4"},me={key:3,class:"text-center py-12"},xe=e({__name:"Draw",setup(e){const r=o(),P=c(),_=M(),D=d([]),W=d(1),z=d([]),{activeParticipants:A,winners:Q,selectedParticipant:xe,selectParticipant:ve,markAsWinner:be,clearSelection:ye,resetAllWinners:fe}=r,{getNextAvailablePrize:he,consumePrize:we}=P,{settings:ke,isDrawing:Ce,drawProgress:je,startDrawing:Me,stopDrawing:Pe,updateDrawProgress:_e}=_,De=u(()=>he()),We=u(()=>{const e=Math.min(A.length,20);return Array.from({length:e},(e,t)=>t+1)});let ze=null;const Ae=()=>{if(0===A.length||0===W.value)return;Me(),D.value=[],z.value=[],ye();let e=0;const t=50/ke.animationDuration*100;ze=setInterval(()=>{if(e+=t,_e(e),e<90){const e=Math.floor(Math.random()*A.length),t=A[e];ve(t.id)}e>=100&&Ie()},50)},Qe=()=>{ze&&(clearInterval(ze),ze=null),Pe(),D.value=[]},Ie=()=>{ze&&(clearInterval(ze),ze=null),Pe();const e=[...A],t=[],a=De.value?Math.min(W.value,De.value.remainingQuantity,e.length):Math.min(W.value,e.length);for(let l=0;l<a;l++){const a=Math.floor(Math.random()*e.length),l=e.splice(a,1)[0];De.value&&t.push({...l,prizeWon:De.value.title})}D.value=t},Se=()=>{if(D.value.length>0&&De.value){D.value.forEach((e,t)=>{be(e.id,e.prizeWon)});for(let e=0;e<D.value.length;e++)De.value.remainingQuantity>0&&we(De.value.id);D.value=[],ye()}},qe=()=>{D.value=[],ye(),A.length>0&&setTimeout(()=>Ae(),500)},Be=()=>{confirm("æ‚¨ç¢ºå®šè¦é‡è¨­æ‰€æœ‰ç²çè€…å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚")&&(fe(),P.resetAllPrizes(),D.value=[],ye())};return p(()=>A.length,e=>{W.value>e&&(W.value=Math.max(1,e))}),g(()=>{ze&&clearInterval(ze),A.length>0&&(W.value=1)}),(e,r)=>{const o=v("router-link");return n(),t("div",S,[l("header",q,[l("div",B,[l("div",U,[r[2]||(r[2]=l("h1",{class:"text-2xl font-bold text-gray-900"},"ğŸ¯ å¹¸é‹æŠ½ç",-1)),m(o,{to:"/",class:"btn-secondary"},{default:x(()=>[...r[1]||(r[1]=[C("â† è¿”å›é¦–é ",-1)])]),_:1})])])]),l("main",E,[l("div",F,[l("div",N,[l("div",null,[r[3]||(r[3]=l("h2",{class:"text-xl font-semibold text-gray-900"},"æº–å‚™æŠ½çï¼Ÿ",-1)),l("p",T,"å‰©é¤˜ "+i(b(A).length)+" ååƒèˆ‡è€…",1)]),l("div",V,[l("div",$,[r[4]||(r[4]=l("label",{class:"text-sm font-medium text-gray-700 whitespace-nowrap"},"æŠ½å–äººæ•¸:",-1)),y(l("select",{"onUpdate:modelValue":r[0]||(r[0]=e=>W.value=e),disabled:b(Ce),class:a(["p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",{"opacity-50 cursor-not-allowed":b(Ce)}])},[(n(!0),t(h,null,w(We.value,e=>(n(),t("option",{key:e,value:e},i(e)+" å ",9,H))),128))],10,G),[[f,W.value]])]),l("div",J,[b(Ce)?(n(),t("button",{key:1,onClick:Qe,class:"btn-danger px-8 py-3 text-lg font-semibold"}," â¹ï¸ åœæ­¢æŠ½ç ")):(n(),t("button",{key:0,onClick:Ae,disabled:0===b(A).length||0===W.value,class:a(["btn-primary px-8 py-3 text-lg font-semibold",{"opacity-50 cursor-not-allowed":0===b(A).length||0===W.value}])}," ğŸ² æŠ½å– "+i(W.value)+" å ",11,K)),b(Q).length>0?(n(),t("button",{key:2,onClick:Be,class:"btn-secondary"}," ğŸ”„ é‡è¨­æ‰€æœ‰ ")):s("",!0)])])]),b(Ce)?(n(),t("div",L,[l("div",O,[l("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-100",style:k({width:b(je)+"%"})},null,4)]),l("p",R," æ­£åœ¨æŠ½å– "+i(W.value)+" åç²çè€…... ",1)])):s("",!0)]),De.value?(n(),t("div",X,[r[5]||(r[5]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"ç•¶å‰çå“",-1)),l("div",Y,i(De.value.title),1),l("p",Z,i(De.value.description),1),l("div",ee,[l("div",te," å‰©é¤˜çå“: "+i(De.value.remainingQuantity)+" / "+i(De.value.quantity),1),l("div",ae," æœ¬æ¬¡æŠ½å–: "+i(Math.min(W.value,De.value.remainingQuantity))+" å ",1)]),W.value>De.value.remainingQuantity?(n(),t("div",le," âš ï¸ æŠ½å–äººæ•¸è¶…éå‰©é¤˜çå“æ•¸é‡ï¼Œå°‡èª¿æ•´ç‚º "+i(De.value.remainingQuantity)+" å ",1)):s("",!0)])):s("",!0),1===D.value.length?(n(),t("div",se,[r[6]||(r[6]=l("div",{class:"text-6xl mb-4"},"ğŸ‰",-1)),r[7]||(r[7]=l("h3",{class:"text-3xl font-bold text-gray-900 mb-4"},"æ­å–œï¼",-1)),l("div",ie,i(D.value[0].name),1),D.value[0].position?(n(),t("div",ne,i(D.value[0].position),1)):s("",!0),l("div",re,"ç²ç: "+i(D.value[0].prizeWon),1),l("div",{class:"mt-6 flex justify-center gap-4"},[l("button",{onClick:Se,class:"btn-primary"},"ç¢ºèªç²çè€…"),l("button",{onClick:qe,class:"btn-secondary"},"é‡æ–°æŠ½ç")])])):D.value.length>1?(n(),t("div",oe,[r[9]||(r[9]=l("div",{class:"text-center"},[l("div",{class:"text-6xl mb-4"},"ğŸ‰"),l("h3",{class:"text-3xl font-bold text-gray-900 mb-6"},"æ­å–œæ‰€æœ‰ç²çè€…ï¼")],-1)),l("div",ce,[(n(!0),t(h,null,w(D.value,(e,a)=>(n(),t("div",{key:e.id,class:"bg-white p-4 rounded-lg border border-yellow-300 text-center"},[r[8]||(r[8]=l("div",{class:"text-2xl mb-2"},"ğŸ†",-1)),l("div",de,i(e.name),1),e.position?(n(),t("div",ue,i(e.position),1)):s("",!0),l("div",pe,i(e.prizeWon),1)]))),128))]),l("div",{class:"flex justify-center gap-4"},[l("button",{onClick:Se,class:"btn-primary"},"ç¢ºèªæ‰€æœ‰ç²çè€…"),l("button",{onClick:qe,class:"btn-secondary"},"é‡æ–°æŠ½ç")])])):s("",!0),l("div",ge,[(n(!0),t(h,null,w(b(A),e=>{var t;return n(),j(I,{key:e.id,participant:e,"is-drawing":b(Ce),"is-selected":(null==(t=b(xe))?void 0:t.id)===e.id||D.value.some(t=>t.id===e.id),onClick:t=>b(ve)(e.id)},null,8,["participant","is-drawing","is-selected","onClick"])}),128))]),0===b(A).length?(n(),t("div",me,[r[11]||(r[11]=l("div",{class:"text-6xl mb-4"},"ğŸ¯",-1)),r[12]||(r[12]=l("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"ç„¡å¯ç”¨åƒèˆ‡è€…",-1)),r[13]||(r[13]=l("p",{class:"text-gray-600 mb-4"},"æ–°å¢ä¸€äº›åƒèˆ‡è€…ä»¥é–‹å§‹å¹¸é‹æŠ½çï¼",-1)),m(o,{to:"/",class:"btn-primary"},{default:x(()=>[...r[10]||(r[10]=[C("æ–°å¢åƒèˆ‡è€…",-1)])]),_:1})])):s("",!0)])])}}});export{xe as default};
