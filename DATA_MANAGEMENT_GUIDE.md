# 數據管理功能使用指南

## 概述

Lucky Draw 抽獎系統現在支持完整的數據持久化功能，讓您可以：
- ✅ 自動儲存所有資料到瀏覽器
- 📥 匯入之前儲存的抽獎狀態
- 📤 匯出完整狀態作為備份
- 🔄 關閉瀏覽器後重新開啟，資料自動恢復
- 🗑️ 清除所有資料重新開始

## 功能詳解

### 1. 自動儲存 🔄

**如何運作：**
- 系統會自動將所有資料儲存到瀏覽器的 localStorage
- 每次新增參與者、獎品或選出獲獎者時，都會自動儲存
- 無需手動操作，完全自動化

**什麼會被儲存：**
- ✅ 所有參與者資料（姓名、職位、群組等）
- ✅ 所有獎品設定（名稱、描述、數量、剩餘數量等）
- ✅ 所有獲獎者記錄（誰中獎、中什麼獎、抽獎順序等）
- ✅ 參與者的獲獎狀態

**重新開啟應用：**
1. 關閉瀏覽器分頁
2. 重新開啟應用網址
3. 所有資料自動恢復，完全保留之前的狀態

**適用場景：**
- 聖誕派對進行到一半，需要休息
- 分多次抽獎，每天抽一部分
- 意外關閉瀏覽器，不用擔心資料遺失

---

### 2. 匯出完整狀態 📤

**位置：**
首頁 → "數據管理" 區塊 → "匯出完整狀態" 按鈕

**如何使用：**
1. 點擊"匯出完整狀態"按鈕
2. 瀏覽器會自動下載一個 JSON 檔案
3. 檔案名稱格式：`lucky-draw-state-2025-11-04.json`

**匯出內容：**
```json
{
  "exportDate": "2025-11-04T15:30:00.000Z",
  "version": "1.0",
  "participants": [...],  // 所有參與者
  "prizes": [...],        // 所有獎品
  "settings": {...}       // 設定（未來擴充）
}
```

**使用場景：**
- 📁 **多個抽獎活動**：為不同活動建立不同的資料檔案
  - 聖誕派對抽獎 → `christmas-2025.json`
  - 員工年會抽獎 → `annual-party-2025.json`
  - VIP 客戶抽獎 → `vip-draw-2025.json`

- 💾 **備份重要資料**：在進行重要抽獎前先備份

- 📊 **歷史記錄保存**：保留每年的抽獎記錄

- 🔄 **不同電腦之間轉移**：在辦公室匯出，回家繼續工作

**建議：**
- 重要活動前先匯出備份
- 使用有意義的檔案名稱（可手動重新命名）
- 定期備份到雲端硬碟（Google Drive、Dropbox等）

---

### 3. 匯入狀態 📥

**位置：**
首頁 → "數據管理" 區塊 → "匯入狀態" 按鈕

**如何使用：**
1. 點擊"匯入狀態"按鈕
2. 選擇之前匯出的 JSON 檔案
3. 系統會顯示確認對話框：
   ```
   即將匯入以下資料:
   
   👥 參與者: 15 人
   🎁 獎品: 6 項
   🏆 獲獎者: 3 人
   
   ⚠️ 此操作將覆蓋當前所有資料！
   是否繼續？
   ```
4. 確認後，所有資料將被替換

**⚠️ 重要提醒：**
- 匯入會**完全覆蓋**當前所有資料
- 建議先匯出當前狀態作為備份
- 確認匯入的檔案是正確的

**使用場景：**

**場景 A：多個抽獎活動切換**
```
早上 10:00 - 聖誕派對抽獎
1. 匯出當前狀態：christmas-2025.json
2. 匯入：vip-draw-2025.json
3. 進行 VIP 客戶抽獎

下午 14:00 - 繼續聖誕派對
1. 匯入：christmas-2025.json
2. 繼續之前的抽獎
```

**場景 B：不同電腦之間轉移**
```
辦公室電腦：
1. 設定好所有參與者和獎品
2. 匯出：party-setup.json
3. 用 Email/USB/雲端傳送檔案

活動現場電腦：
1. 開啟抽獎系統
2. 匯入：party-setup.json
3. 立即開始抽獎
```

**場景 C：測試和正式環境**
```
測試階段：
1. 載入範例數據
2. 測試抽獎流程
3. 清除所有資料

正式活動：
1. 匯入之前準備好的正式資料
2. 開始正式抽獎
```

---

### 4. 清除所有資料 🗑️

**位置：**
首頁 → "數據管理" 區塊 → "清除所有資料" 按鈕

**如何使用：**
1. 點擊"清除所有資料"按鈕
2. 系統會顯示確認對話框：
   ```
   ⚠️ 確定要清除所有資料嗎？
   
   這將刪除:
   👥 15 位參與者
   🎁 6 個獎品
   🏆 3 位獲獎者
   
   💡 建議先匯出資料備份！
   此操作無法復原。
   ```
3. 確認後，所有資料被清除

**⚠️ 危險操作：**
- 此操作**無法復原**
- 建議先匯出備份
- 會清除瀏覽器 localStorage 中的所有資料

**使用場景：**
- 測試完成，準備開始正式活動
- 活動結束，清除資料開始新的活動
- 出現資料錯誤，需要重新開始

---

## 完整工作流程範例

### 範例 1：準備多個抽獎活動

```
週一：準備 VIP 抽獎
1. 新增 50 位 VIP 參與者
2. 設定 10 種高級獎品
3. 匯出 → vip-draw-2025-12-20.json
4. 清除所有資料

週二：準備員工抽獎
1. 匯入員工名單 CSV
2. 設定 20 種員工獎品
3. 匯出 → staff-draw-2025-12-21.json
4. 清除所有資料

週三：準備客戶抽獎
1. 新增 100 位客戶
2. 設定 15 種客戶獎品
3. 匯出 → customer-draw-2025-12-22.json
```

---

### 範例 2：長期抽獎活動

```
第一天（12/20）：
1. 載入範例數據或匯入準備好的資料
2. 抽取"特等獎"（1名）
3. 抽取"一等獎"（2名）
4. 自動儲存（無需手動操作）
5. 關閉瀏覽器

第二天（12/21）：
1. 重新開啟應用
2. 資料自動恢復（已經選出3位獲獎者）
3. 繼續抽取"二等獎"（3名）
4. 抽取"三等獎"（5名）
5. 關閉瀏覽器

第三天（12/22）：
1. 重新開啟應用
2. 資料自動恢復（已經選出11位獲獎者）
3. 抽取剩餘獎品
4. 完成抽獎
5. 匯出最終結果 → final-results-2025-12-22.json
```

---

### 範例 3：多地點抽獎

```
總部（準備階段）：
1. 設定所有參與者和獎品
2. 匯出 → company-annual-draw-2025.json
3. Email 發送給各分公司

分公司 A：
1. 匯入 → company-annual-draw-2025.json
2. 篩選本分公司參與者
3. 進行抽獎
4. 匯出 → branch-a-results.json

分公司 B：
1. 匯入 → company-annual-draw-2025.json
2. 篩選本分公司參與者
3. 進行抽獎
4. 匯出 → branch-b-results.json
```

---

## 常見問題 FAQ

### Q1: 資料儲存在哪裡？
A: 儲存在您的瀏覽器 localStorage 中，只在您的電腦上，不會上傳到任何伺服器。

### Q2: 清除瀏覽器快取會刪除資料嗎？
A: 是的！清除瀏覽器快取會刪除 localStorage。**建議定期匯出備份**。

### Q3: 可以在不同瀏覽器之間共用資料嗎？
A: 不行。每個瀏覽器的 localStorage 是獨立的。需要使用"匯出/匯入"功能轉移資料。

### Q4: 可以同時管理多個抽獎嗎？
A: 可以！使用"匯出/匯入"功能切換不同的抽獎活動。

### Q5: 匯入會覆蓋當前資料嗎？
A: 是的！匯入前建議先匯出當前資料作為備份。

### Q6: 手機和電腦可以共用資料嗎？
A: 可以！在電腦匯出 JSON 檔案，傳送到手機後匯入即可。

### Q7: 檔案大小會很大嗎？
A: 不會。100位參與者 + 20個獎品 ≈ 20-30 KB，非常小。

### Q8: 可以編輯匯出的 JSON 檔案嗎？
A: 技術上可以，但**不建議**。手動編輯可能導致格式錯誤無法匯入。

---

## 最佳實踐建議

### ✅ 建議做法

1. **定期備份**
   - 重要活動前先匯出備份
   - 每天結束前匯出一次
   - 儲存到雲端硬碟

2. **檔案命名規則**
   ```
   活動名稱-日期-版本.json
   例如：
   christmas-party-2025-12-20-v1.json
   christmas-party-2025-12-20-v2.json
   christmas-party-2025-12-20-final.json
   ```

3. **測試流程**
   - 先用範例數據測試
   - 確認流程無誤後清除
   - 再匯入正式資料

4. **多重備份**
   - 電腦本地備份
   - 雲端硬碟備份
   - Email 給自己備份

### ❌ 避免做法

1. 不要依賴單一備份
2. 不要在清除瀏覽器快取後才想到備份
3. 不要在重要活動時才第一次使用系統
4. 不要手動編輯 JSON 檔案
5. 不要忘記確認匯入的檔案是否正確

---

## 技術細節

### localStorage Keys
```javascript
'lucky-draw-participants'  // 參與者資料
'lucky-draw-prizes'        // 獎品資料
```

### 匯出檔案格式
```json
{
  "exportDate": "ISO 8601 時間戳記",
  "version": "版本號",
  "participants": [
    {
      "id": "唯一識別碼",
      "name": "姓名",
      "email": "電子郵件（選填）",
      "position": "職位（選填）",
      "group": "群組（選填）",
      "isWinner": "是否獲獎",
      "prizeWon": "獲得的獎品（如果有）",
      "drawOrder": "抽獎順序（如果有）"
    }
  ],
  "prizes": [
    {
      "id": "唯一識別碼",
      "title": "獎品名稱",
      "description": "獎品描述（選填）",
      "quantity": "總數量",
      "remainingQuantity": "剩餘數量",
      "order": "顯示順序"
    }
  ],
  "settings": {}
}
```

---

## 支援

如有問題或建議，請查看 [README.md](./README.md) 或提交 Issue。

🎄 祝您抽獎活動圓滿成功！🎁
